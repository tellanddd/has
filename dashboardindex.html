
<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù‡ÙˆØ´Ù…Ù†Ø¯ TELLAND</title>
  <style>
    body {
      font-family: 'Vazirmatn', sans-serif;
      background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
      color: white;
      padding: 2rem;
    }

    .login-box, .dashboard {
      max-width: 500px;
      margin: 2rem auto;
      background: rgba(255,255,255,0.07);
      padding: 2rem;
      border-radius: 15px;
      backdrop-filter: blur(10px);
      box-shadow: 0 8px 30px rgba(0,0,0,0.2);
    }

    input, button, textarea {
      width: 100%;
      margin-top: 1rem;
      padding: 0.7rem;
      border: none;
      border-radius: 10px;
      font-size: 1rem;
    }

    button {
      background: #4caf50;
      color: white;
      cursor: pointer;
    }

    .hidden {
      display: none;
    }

    .customer-item {
      background: rgba(255,255,255,0.08);
      padding: 1rem;
      border-radius: 10px;
      margin: 1rem 0;
    }

    .summary {
      margin: 2rem auto;
      text-align: center;
    }

    @media (max-width: 600px) {
      body { padding: 1rem; }
    }
  </style>
</head>
<body onload="checkAuth()">

<div class="login-box" id="loginBox">
  <h2 style="text-align:center;">ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ø³ÛŒØ³ØªÙ…</h2>
  <input type="password" id="password" placeholder="Ø±Ù…Ø² ÙˆØ±ÙˆØ¯">
  <button onclick="login()">ÙˆØ±ÙˆØ¯</button>
</div>

<div class="dashboard hidden" id="dashboard">
  <h2 style="text-align:center;">Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ù…Ø´ØªØ±ÛŒØ§Ù† TELLAND</h2>

  <form id="customerForm">
    <input type="text" id="name" placeholder="Ù†Ø§Ù… Ù…Ø´ØªØ±ÛŒ" required>
    <input type="text" id="phone" placeholder="Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³" required>
    <input type="text" id="price" placeholder="Ù…Ø¨Ù„Øº Ø®Ø±ÛŒØ¯" required>
    <textarea id="note" placeholder="ØªÙˆØ¶ÛŒØ­Ø§Øª ÛŒØ§ Ø¢Ø¯Ø±Ø³"></textarea>
    <button type="submit">Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø´ØªØ±ÛŒ</button>
  </form>

  
<div style="text-align:center; margin: 1rem auto;">
  <input type="text" id="searchInput" placeholder="ğŸ” Ø¬Ø³ØªØ¬Ùˆ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù†Ø§Ù… ÛŒØ§ Ø´Ù…Ø§Ø±Ù‡" oninput="searchCustomers()" style="padding: 0.6rem; border-radius: 10px; width: 80%;">
</div>
<div class="summary">
    <strong>ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„ Ù…Ø´ØªØ±ÛŒâ€ŒÙ‡Ø§: <span id="totalCount">0</span></strong><br>
    <strong>Ù…Ø¬Ù…ÙˆØ¹ Ù…Ø¨Ø§Ù„Øº: <span id="totalPrice">0</span> ØªÙˆÙ…Ø§Ù†</strong><br><br>
    <button onclick="exportCSV()">ğŸ“¥ Ø®Ø±ÙˆØ¬ÛŒ Ø§Ú©Ø³Ù„</button> <button onclick="syncToCloud()">â˜ï¸ Ø°Ø®ÛŒØ±Ù‡ Ø§Ø¨Ø±ÛŒ</button>
    <button onclick="window.print()">ğŸ–¨ï¸ Ú†Ø§Ù¾ Ù„ÛŒØ³Øª</button>
  </div>

  
<div id="customerList"></div>

<div class="summary">
  <h3>ğŸ“˜ Ù„Ø§Ú¯ ÙØ¹Ø§Ù„ÛŒØª</h3>
  <ul id="activityLog" style="text-align:right; list-style:none; padding:0;"></ul>
</div>

</div>

<script>
  const correctPassword = "telland2025";  // Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø³Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ ÙˆØ±ÙˆØ¯

  function login() {
    const inputPass = document.getElementById("password").value;
    if (inputPass === correctPassword) {
      document.getElementById("loginBox").classList.add("hidden");
      document.getElementById("dashboard").classList.remove("hidden");
      renderCustomers();
    } else {
      alert("Ø±Ù…Ø² Ù†Ø§Ø¯Ø±Ø³Øª Ø§Ø³Øª!");
    }
  }

  const form = document.getElementById("customerForm");
  const customerList = document.getElementById("customerList");
  let customers = JSON.parse(localStorage.getItem("customers") || "[]");

  form.addEventListener("submit", function (e) {
    e.preventDefault();
    const name = document.getElementById("name").value.trim();
    const phone = document.getElementById("phone").value.trim();
    const price = parseInt(document.getElementById("price").value.trim());
    const note = document.getElementById("note").value.trim();
    if (!name || !phone || !price) return;

    customers.push({ name, phone, price, note });
    localStorage.setItem("customers", JSON.stringify(customers));
    renderCustomers();
    form.reset();
  });

  function renderCustomers() {
    customerList.innerHTML = "";
    let total = 0;
    customers.forEach((c, i) => {
      const div = document.createElement("div");
      div.className = "customer-item";
      total += parseInt(c.price);
      div.innerHTML = `
        <div><strong>#${i + 1} ğŸ‘¤ <span contenteditable="true" oninput="editCustomer(${i}, 'name', this.innerText)">${c.name}</span></strong></div>
        <div>ğŸ“ <span contenteditable="true" oninput="editCustomer(${i}, 'phone', this.innerText)">${c.phone}</span></div>
        <div>ğŸ’° <span contenteditable="true" oninput="editCustomer(${i}, 'price', this.innerText)">${c.price}</span> ØªÙˆÙ…Ø§Ù†</div>
        <div>ğŸ“ <span contenteditable="true" oninput="editCustomer(${i}, 'note', this.innerText)">${c.note}</span></div>
        <button onclick="deleteCustomer(${i})" style="margin-top: 0.5rem; background:#e53935; color:white;">âŒ Ø­Ø°Ù</button>
      `;
      customerList.appendChild(div);
    });

    document.getElementById("totalCount").innerText = customers.length;
    document.getElementById("totalPrice").innerText = total;
  }

  function editCustomer(index, field, value) {
    customers[index][field] = value;
    localStorage.setItem("customers", JSON.stringify(customers));
    renderCustomers();
  }

  function deleteCustomer(index) {
    customers.splice(index, 1);
    localStorage.setItem("customers", JSON.stringify(customers));
    renderCustomers();
  }

  function exportCSV() {
    let csv = "Ø±Ø¯ÛŒÙ,Ù†Ø§Ù…,Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³,Ù…Ø¨Ù„Øº,ÛŒØ§Ø¯Ø¯Ø§Ø´Øª\n";
    customers.forEach((c, i) => {
      csv += `${i + 1},${c.name},${c.phone},${c.price},${c.note}\n`;
    });
    const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "customers.csv";
    a.click();
  }

function searchCustomers() {
  const query = document.getElementById("searchInput").value.toLowerCase();
  const items = document.querySelectorAll(".customer-item");
  items.forEach(item => {
    item.style.display = item.innerText.toLowerCase().includes(query) ? "block" : "none";
  });
}

function logActivity(text) {
  const time = new Date().toLocaleString("fa-IR");
  const logItem = document.createElement("li");
  logItem.innerText = `[${time}] ${text}`;
  document.getElementById("activityLog").prepend(logItem);
}

// Ø°Ø®ÛŒØ±Ù‡ Ù…Ø´ØªØ±ÛŒ
form.addEventListener("submit", function (e) {
  e.preventDefault();
  const name = document.getElementById("name").value.trim();
  const phone = document.getElementById("phone").value.trim();
  const price = parseInt(document.getElementById("price").value.trim());
  const note = document.getElementById("note").value.trim();
  if (!name || !phone || !price) return;

  let category = "ğŸŸ¢ Ù…Ø¹Ù…ÙˆÙ„ÛŒ";
  if (price > 5000000) category = "ğŸ”´ ÙˆÛŒÚ˜Ù‡";
  else if (price > 2000000) category = "ğŸŸ¡ Ø®ÙˆØ¨";

  customers.push({ name, phone, price, note, category });
  localStorage.setItem("customers", JSON.stringify(customers));
  renderCustomers();
  logActivity(`Ù…Ø´ØªØ±ÛŒ Ø¬Ø¯ÛŒØ¯ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯: ${name}`);
  form.reset();
});

// Ø¨Ø§Ø²Ø³Ø§Ø²ÛŒ Ø±Ù†Ø¯Ø± Ø¨Ø§ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ùˆ Ù„Ø§Ú¯
function renderCustomers() {
  customerList.innerHTML = "";
  let total = 0;
  customers.forEach((c, i) => {
    const div = document.createElement("div");
    div.className = "customer-item";
    total += parseInt(c.price);
    div.innerHTML = `
      <div><strong>#${i + 1} ğŸ‘¤ <span contenteditable="true" oninput="editCustomer(${i}, 'name', this.innerText)">${c.name}</span></strong> (${c.category || 'ğŸŸ¢ Ù…Ø¹Ù…ÙˆÙ„ÛŒ'})</div>
      <div>ğŸ“ <span contenteditable="true" oninput="editCustomer(${i}, 'phone', this.innerText)">${c.phone}</span></div>
      <div>ğŸ’° <span contenteditable="true" oninput="editCustomer(${i}, 'price', this.innerText)">${c.price}</span> ØªÙˆÙ…Ø§Ù†</div>
      <div>ğŸ“ <span contenteditable="true" oninput="editCustomer(${i}, 'note', this.innerText)">${c.note}</span></div>
      <button onclick="deleteCustomer(${i})" style="margin-top: 0.5rem; background:#e53935; color:white;">âŒ Ø­Ø°Ù</button>
    `;
    customerList.appendChild(div);
  });

  document.getElementById("totalCount").innerText = customers.length;
  document.getElementById("totalPrice").innerText = total;
}

function editCustomer(index, field, value) {
  customers[index][field] = value;
  localStorage.setItem("customers", JSON.stringify(customers));
  logActivity(`ÙˆÛŒØ±Ø§ÛŒØ´ Ù…Ø´ØªØ±ÛŒ: ÙÛŒÙ„Ø¯ ${field} ØªØºÛŒÛŒØ± ÛŒØ§ÙØª Ø¨Ø±Ø§ÛŒ ${customers[index].name}`);
}

function deleteCustomer(index) {
  const name = customers[index].name;
  customers.splice(index, 1);
  localStorage.setItem("customers", JSON.stringify(customers));
  logActivity(`Ù…Ø´ØªØ±ÛŒ Ø­Ø°Ù Ø´Ø¯: ${name}`);
  renderCustomers();
}

// Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø§Ø¨Ø±ÛŒ (Ø¯Ø± Ú©Ù†Ø³ÙˆÙ„)
function syncToCloud() {
  console.log("ğŸ“¡ Ø¯Ø± Ø­Ø§Ù„ Ø¢Ù¾Ù„ÙˆØ¯ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨Ù‡ ÙØ¶Ø§ÛŒ Ø§Ø¨Ø±ÛŒ...");
  console.log(JSON.stringify(customers, null, 2));
  alert("Ø°Ø®ÛŒØ±Ù‡ Ø§Ø¨Ø±ÛŒ Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯ (Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ)");
}

function checkAuth() {
  const access = localStorage.getItem("auth");
  if (access !== "granted") {
    alert("â›” Ø¯Ø³ØªØ±Ø³ÛŒ ØºÛŒØ±Ù…Ø¬Ø§Ø²! Ø§Ø¨ØªØ¯Ø§ ÙˆØ§Ø±Ø¯ Ø´ÙˆÛŒØ¯.");
    window.location.href = "login_TELLAND_secure.html";
  }
}
</script>

</body>
</html>
